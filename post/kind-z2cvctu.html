<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.131.0"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="类"><meta itemprop=description content><meta name=description content><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="/imgs/hugo_next_avatar.png"><meta itemprop=keywords content="类"><meta property="og:type" content="article"><meta property="og:title" content="类"><meta property="og:description" content><meta property="og:image" content="/imgs/hugo_next_avatar.png"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="/post/kind-z2cvctu.html"><meta property="og:site_name" content="Sakura Notes"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="arukasxy"><meta property="article:published_time" content="2024-07-10 20:24:49 +0800 +0800"><meta property="article:modified_time" content="2024-08-08 13:04:20 +0800 +0800"><link type=text/css rel=stylesheet href=/3rd/font-awesome/6.6.0/css/all.min.css><link type=text/css rel=stylesheet href=/3rd/animate.css/4.1.1/animate.min.css><link type=text/css rel=stylesheet href=/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href=/css/main.min.ab1c3ae9fc9258afee98d91f39e4c6c4fe3d7d90222efbbe570558fcadfc2105.css><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"kind-z2cvctu.html","permalink":"/post/kind-z2cvctu.html","title":"类","waline":{"js":[{"alias":"@waline/client","alias_name":"waline","file":"dist/pageview.js","name":"pageview","version":"2.15.8"},{"alias":"@waline/client","alias_name":"waline","file":"dist/comment.js","name":"comment","version":"2.15.8"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>类 - Sakura Notes</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Sakura Notes</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>计算机,C++,数据库</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>18</span></a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#访问控制>访问控制</a></li></ul><ul><li><a href=#多继承>多继承</a></li><li><a href=#虚拟继承>虚拟继承</a></li></ul><ul><li><a href=#编译时多态静态多态>编译时多态（静态多态）</a></li><li><a href=#运行时多态动态多类>运行时多态（动态多类）</a></li></ul><ul><li><a href=#静态成员变量>静态成员变量</a></li></ul><ul><li><a href=#虚函数>虚函数</a></li><li><a href=#运算符>运算符</a></li><li><a href=#判断类是否有某函数sfinae>判断类是否有某函数SFINAE</a></li><li><a href=#静态成员函数>静态成员函数</a></li><li><a href=#crtp调用子类函数>CRTP（调用子类函数）</a></li><li><a href=#默认成员函数>默认成员函数</a></li></ul><ul><li><a href=#字节对齐>字节对齐</a></li></ul><ul><li><a href=#删除构造函数>删除构造函数</a></li><li><a href=#禁止隐式类型转换>禁止隐式类型转换</a></li><li><a href=#子类构造函数>子类构造函数</a></li></ul><ul><li><a href=#禁止复制>禁止复制</a></li><li><a href=#可复制>可复制</a></li></ul><ul><li><a href=#禁止移动>禁止移动</a></li></ul><ul><li><a href=#子类析构函数>子类析构函数</a></li></ul><ul><li><a href=#禁用赋值>禁用赋值</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=arukasxy src=/imgs/img-lazy-loading.gif data-src=/imgs/hugo_next_avatar.png><p class=site-author-name itemprop=name>arukasxy</p><div class=site-description itemprop=description></div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>18</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>7</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>19</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/arukasxy title="Github → https://github.com/arukasxy" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate=2024-08-08T00:00:00+08:00></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=42145></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=93></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate=2024-07-09T10:57:10+08:00></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/hugo-next rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=/post/kind-z2cvctu.html><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/hugo_next_avatar.png"><meta itemprop=name content="arukasxy"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="arukasxy"><meta itemprop=description content></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="类"><meta itemprop=description content="类 struct class struct 默认访问权限 private public 默认继承 private public 定义模板参数 （代替typename） √ × C++对struct进行了拓展，和C中的struct不同 封装 与C"></span><header class=post-header><h1 class=post-title itemprop="name headline">类
<a href=https://github.com/user-name/repo-name/tree/branch-name/subdirectory-name/post/kind-z2cvctu.md rel="noopener external nofollow noreferrer" target=_blank class="exturl post-edit-link" title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2024-07-10 20:24:49 +0800 +0800" itemprop="dateCreated datePublished" datetime="2024-07-10 20:24:49 +0800 +0800">2024-07-10
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar-check"></i>
</span><span class=post-meta-item-text title=更新于>更新于：
</span><time title=修改时间：2024-08-08T13:04:20+08:00 itemprop=dateModified datetime=2024-08-08T13:04:20+08:00>2024-08-08</time>
</span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E8%AF%AD%E6%B3%95 itemprop=url rel=index><span itemprop=name>语法</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>5275</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>11分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv data-path=/post/kind-z2cvctu.html><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><h1 id=类>类
<a class=header-anchor href=#%e7%b1%bb></a></h1><h1 id=struct>struct
<a class=header-anchor href=#struct></a></h1><table><thead><tr><th></th><th>class</th><th>struct</th></tr></thead><tbody><tr><td>默认访问权限</td><td>private</td><td>public</td></tr><tr><td>默认继承</td><td>private</td><td>public</td></tr><tr><td>定义模板参数<br>（代替typename）</td><td>√</td><td>×</td></tr></tbody></table><blockquote><p>C++对struct进行了拓展，和C中的struct不同</p></blockquote><h1 id=封装>封装
<a class=header-anchor href=#%e5%b0%81%e8%a3%85></a></h1><p>与C中的struct不同，类将数据和函数结合起来，使用访问权限来隐藏实现细节，提供对外接口</p><h2 id=访问控制>访问控制
<a class=header-anchor href=#%e8%ae%bf%e9%97%ae%e6%8e%a7%e5%88%b6></a></h2><table><thead><tr><th></th><th>子类</th><th>友元</th><th>类外</th></tr></thead><tbody><tr><td>public</td><td>√</td><td>√</td><td>√</td></tr><tr><td>protected</td><td>√</td><td>√</td><td>×</td></tr><tr><td>private</td><td>×</td><td>√</td><td>×</td></tr></tbody></table><h1 id=继承>继承
<a class=header-anchor href=#%e7%bb%a7%e6%89%bf></a></h1><p>内存布局<sup>（https://www.cnblogs.com/QG-whz/p/4909359.html）</sup>：虚函数表指针vfptr <sup>(如果父类没有虚函数，则没有)</sup>+ 基类非静态成员 + 派生类非静态成员</p><ul><li>默认private继承</li></ul><h2 id=多继承>多继承
<a class=header-anchor href=#%e5%a4%9a%e7%bb%a7%e6%89%bf></a></h2><p>内存布局：（虚函数表指针vfptr<sup>(如果基类中没有虚函数表，则不需要vfptr)</sup> + 基类非静态成员<sup>（如果基类存在基类，则先写基类的基类的成员变量，再写基类的成员变量）</sup>） * 基类个数<sup>（按继承顺序）</sup> + 派生类非静态成员</p><p>使用：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>IMachine</span><span style=color:#f92672>:</span> IPrinter, IScanner
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Derived</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> BaseA, <span style=color:#66d9ef>public</span> BaseB { }
</span></span></code></pre></div><h2 id=虚拟继承>虚拟继承
<a class=header-anchor href=#%e8%99%9a%e6%8b%9f%e7%bb%a7%e6%89%bf></a></h2><p>内存布局：（虚函数表指针vfptr + 虚基类指针vbptr + 基类非静态成员<sup>（不包含基类的基类）</sup>）* 基类个数 + 虚祖父类非静态成员<sup>（如果仅是B虚继承A,则没有虚祖父类；仅在虚拟菱形继承中存在）</sup> + 派生类非静态成员</p><p>原理：原本的父类成员会被替换为 一个<strong>虚基类指针vbptr</strong>，这个指针指向一张<strong>虚基类表</strong>，虚基类表里存放 <strong>vbptr到该类首地址的偏移</strong>。</p><p>作用：</p><ol><li>解决多继承/菱形继承的“数据冗余”：在一个派生类中保留间接基类的多份同名成员，例如A派生B和C，D继承了B和C，则A的成员变量和成员函数在D中有两份。<strong>虚继承中仅保留一份间接基类的成员</strong>。</li><li>解决命名冲突：D如果想访问A的成员变量，则编译器不知道它究竟来自 A &ndash;>B&ndash;>D 这条路径，还是来自 A&ndash;>C&ndash;>D 这条路径，产生二义性，需要使用B::m_a来指明。</li></ol><p>使用：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>B</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>public</span> A{}
</span></span></code></pre></div><h1 id=多态>多态
<a class=header-anchor href=#%e5%a4%9a%e6%80%81></a></h1><p>含义：根据不同的对象类型，调用不同的函数</p><h2 id=编译时多态静态多态>编译时多态（静态多态）
<a class=header-anchor href=#%e7%bc%96%e8%af%91%e6%97%b6%e5%a4%9a%e6%80%81%e9%9d%99%e6%80%81%e5%a4%9a%e6%80%81></a></h2><p><strong>实现</strong>：</p><ul><li>模板template</li><li>函数重载</li><li>CRTP</li></ul><p><strong>原理</strong>：在程序编译阶段，编译器通过<strong>实参匹配形参</strong>的方式确定具体调用哪个函数</p><h2 id=运行时多态动态多类>运行时多态（动态多类）
<a class=header-anchor href=#%e8%bf%90%e8%a1%8c%e6%97%b6%e5%a4%9a%e6%80%81%e5%8a%a8%e6%80%81%e5%a4%9a%e7%b1%bb></a></h2><p><strong>实现</strong>：</p><ol><li>继承</li><li>父类 <strong>指针<sup>（父类对象不行;指针或引用只要求基地址和内存大小,不引发内存任何“与类型有关的内存委托操作;派生类对象直接赋值给基类对象，就牵扯到对象的类型问题）</sup><strong>​</strong>或引<sup>（父类对象不行;指针或引用只要求基地址和内存大小,不引发内存任何"与类型有关的内存委托操作";派生类对象直接赋值给基类对象，就牵扯到对象的类型问题）</sup><strong>​</strong>用<sup>（父类对象不行;指针或引用只要求基地址和内存大小,不引发内存任何“与类型有关的内存委托操作;派生类对象直接赋值给基类对象，就牵扯到对象的类型问题）</sup></strong> 指向子类对象</li><li>父类虚函数 + 子类重写父类的虚函数</li></ol><p>原理：虚函数表</p><h1 id=成员变量>成员变量
<a class=header-anchor href=#%e6%88%90%e5%91%98%e5%8f%98%e9%87%8f></a></h1><ol><li><p>访问权限控制：如果基类中的成员变量需要被子类访问，设为protected；其余设置为private</p></li><li><p>初始化：在定义时使用 = 或 {} 初始化</p><p>C++11前仅能在构造函数的初始化列表中赋值</p><p>C++11后可以在定义时赋值</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Foo</span>(){
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>string<span style=color:#f92672>&gt;</span> name <span style=color:#f92672>=</span> vector<span style=color:#f92672>&lt;</span>string<span style=color:#f92672>&gt;</span>(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> val{vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>(<span style=color:#ae81ff>5</span>,<span style=color:#ae81ff>0</span>)};
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><p>指针或对象：</p><p>对象：无需进行内存管理，无需担心空指针</p><p>指针：</p><ul><li>当成员变量要使用多态时</li><li>当成员变量是可选时，有时不会使用，节省空间</li><li>当成员变量很大时</li><li>当成员变量对应的资源不是对象独有，而是多个对象共同所有</li></ul></li><li><p>引用</p><ul><li>构造函数的形参也必须是引用类型</li><li>不能在构造函数里初始化，必须在<strong>构造函数的初始化列表</strong>中初始化</li></ul></li><li><p>const 只读成员变量</p><ul><li>只能在<strong>构造函数的初始化列表</strong>中初始化</li></ul></li></ol><h2 id=静态成员变量>静态成员变量
<a class=header-anchor href=#%e9%9d%99%e6%80%81%e6%88%90%e5%91%98%e5%8f%98%e9%87%8f></a></h2><p>必须在类外<sup>（不能在类中、初始化列表中初始化）</sup>初始化</p><p>作用：在所有实例之间共享数据；将数据存储在类中</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>class_name</span>{
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> x;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> class_name<span style=color:#f92672>::</span>x <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span></code></pre></div><h1 id=成员函数>成员函数
<a class=header-anchor href=#%e6%88%90%e5%91%98%e5%87%bd%e6%95%b0></a></h1><h2 id=虚函数>虚函数
<a class=header-anchor href=#%e8%99%9a%e5%87%bd%e6%95%b0></a></h2><p>作用：实现多态；重写函数<sup>（如类库、框架源码不能修改时使用虚函数重写）</sup></p><p>纯虚函数：定义接口，不需要实现，抽象类不能实例化，<strong>仅能定义指针和引用</strong>，使用多态</p><p><strong>特点</strong>：</p><ul><li><p>可以是内联函数，通过对象调用虚函数可以内联，但虚函数表现多态<sup>（使用基类指针调用子类对象）</sup>时会忽略inline</p></li><li><p>可以是private，且可被子类覆盖；但需要检查使用多态指针的函数<sup>（如main函数，并不是指虚函数）</sup>必须为友元</p></li><li><p>如果对象没有实例化<sup>（调用构造函数之后才有虚函数表指针）</sup>，不能调用虚函数</p></li><li><p><strong>override</strong> 编译器会检查父类是否有同名方法，且更易阅读</p></li><li><p>不能是成员模板函数template</p><p>函数模板在<strong>声明</strong>时编译一次，在<strong>调用</strong>时编译一次。只有当所有编译单元完成时，才能确定被展开为多少种形式</p><p>虚函数表在<strong>类编译完成时</strong>已经被确定</p></li></ul><p>实现：每个<strong>对象</strong>有虚函数表指针 + 每个<strong>类</strong>有虚函数表（父类和子类有各自的虚函数表）</p><ul><li>子类可以继承<sup>（子类不重写）</sup>、覆盖<sup>（子类重写）</sup>、添加虚函数表中的函数</li><li>父类和子类不共用虚函数表，但表中虚函数地址可能相同（子类没有重写）。</li><li>多态时，父类指针查询的是<strong>子类的虚函数表</strong>，所以可以调用子类的重写函数。</li><li>虚函数表是类编译期间建立的</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#75715e># 虚函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>draw</span>(){}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 纯虚函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>draw</span>() <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 子类重写函数（同函数名、同参数列表、同返回类型）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>draw</span>() <span style=color:#66d9ef>override</span> {
</span></span><span style=display:flex><span>	cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;Drawing a circle&#34;</span> <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=运算符>运算符
<a class=header-anchor href=#%e8%bf%90%e7%ae%97%e7%ac%a6></a></h2><ul><li><p>不能定义新的运算符</p></li><li><p>不能重载的运算符：成员运算符<sup>（A.a）</sup>、指针运算符<sup>（p->a）</sup>、作用域运算符<sup>（A::func()）</sup>、sizeof、三元条件运算符<sup>（?:）</sup></p></li><li><p>只能使用成员函数重载的运算符：=、()、[]、->、new、delete</p></li><li><p>重载运算符的限制</p><ol><li>不能改变运算符<strong>操作数的个数</strong></li><li>不能改变运算符原有的<strong>优先级</strong></li><li>不能改变运算符原有的<strong>结合性</strong></li><li>不能改变运算符原有的<strong>语法结构</strong></li></ol></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#75715e># 全局函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>complex <span style=color:#66d9ef>operator</span><span style=color:#f92672>+</span>(<span style=color:#66d9ef>const</span> complex<span style=color:#f92672>&amp;</span> c1, <span style=color:#66d9ef>const</span> complex<span style=color:#f92672>&amp;</span> c2);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 成员函数(自带一个this指针参数,所以二元函数仅需一个参数)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>complex complex<span style=color:#f92672>::</span><span style=color:#66d9ef>operator</span><span style=color:#f92672>+</span>(<span style=color:#66d9ef>const</span> complex<span style=color:#f92672>&amp;</span> c);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 友元函数(没有this指针参数)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>friend</span> ostream<span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>operator</span><span style=color:#f92672>&lt;&lt;</span>(ostream <span style=color:#f92672>&amp;</span>os,<span style=color:#66d9ef>const</span> complex <span style=color:#f92672>&amp;</span>c)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ++x(前置++)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>student<span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>operator</span><span style=color:#f92672>++</span>(<span style=color:#66d9ef>void</span>){
</span></span><span style=display:flex><span>	<span style=color:#f92672>++</span><span style=color:#66d9ef>this</span><span style=color:#f92672>-&gt;</span>num;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#f92672>*</span><span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># x++(后置++,使用int为参数)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>student <span style=color:#66d9ef>operator</span><span style=color:#f92672>++</span>(<span style=color:#66d9ef>int</span>){
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>student</span> <span style=color:#a6e22e>temp</span>(<span style=color:#f92672>*</span><span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>	<span style=color:#f92672>++</span><span style=color:#66d9ef>this</span><span style=color:#f92672>-&gt;</span>num;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> temp;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=判断类是否有某函数sfinae>判断类是否有某函数SFINAE
<a class=header-anchor href=#%e5%88%a4%e6%96%ad%e7%b1%bb%e6%98%af%e5%90%a6%e6%9c%89%e6%9f%90%e5%87%bd%e6%95%b0sfinae></a></h2><p>SINAE：Substitution Failure Is Not An Error 匹配失败不是错误</p><p>只能判断是否有对应的public函数（看不到private函数）</p><p>参考类型萃取</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#75715e># 不能看到继承的成员函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>has_destroy</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> C<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>char</span> test(<span style=color:#66d9ef>decltype</span>(<span style=color:#f92672>&amp;</span>C<span style=color:#f92672>::</span>destroy));
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> C<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int32_t</span> test(...);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>bool</span> value <span style=color:#f92672>=</span> <span style=color:#66d9ef>sizeof</span>(test<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span>(<span style=color:#ae81ff>0</span>)) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>cout<span style=color:#f92672>&lt;&lt;</span> has_destroy<span style=color:#f92672>&lt;</span>X<span style=color:#f92672>&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span>endl;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#75715e># C++11后，编译时只能-std=c++11
</span></span></span><span style=display:flex><span><span style=color:#75715e># 原理参考类型萃取
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;list&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;map&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;set&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;utility&gt;</span><span style=color:#75715e> </span><span style=color:#75715e>// std::declval
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> void_t <span style=color:#f92672>=</span> <span style=color:#66d9ef>void</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>// #include &lt;type_traits&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T, <span style=color:#66d9ef>typename</span> V <span style=color:#f92672>=</span> <span style=color:#66d9ef>void</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>has_push_back</span><span style=color:#f92672>:</span>std<span style=color:#f92672>::</span>false_type {};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>has_push_back</span><span style=color:#f92672>&lt;</span>T, void_t<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>decltype</span>(std<span style=color:#f92672>::</span>declval<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span>().push_back(std<span style=color:#f92672>::</span>declval<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>::</span>value_type<span style=color:#f92672>&gt;</span>()))<span style=color:#f92672>&gt;&gt;:</span>std<span style=color:#f92672>::</span>true_type {};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_push_back<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>list<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_push_back<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>map<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_push_back<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>set<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_push_back<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>string<span style=color:#f92672>&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_push_back<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#f92672>----------------------------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> void_t <span style=color:#f92672>=</span> <span style=color:#66d9ef>void</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T, <span style=color:#66d9ef>typename</span> V <span style=color:#f92672>=</span> <span style=color:#66d9ef>void</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>has_ss_type</span> <span style=color:#f92672>:</span> std<span style=color:#f92672>::</span>false_type {};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>has_ss_type</span> <span style=color:#f92672>&lt;</span>T, void_t<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>decltype</span>(std<span style=color:#f92672>::</span>declval<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>stringstream<span style=color:#f92672>&gt;</span>().<span style=color:#66d9ef>operator</span><span style=color:#f92672>&lt;&lt;</span>(std<span style=color:#f92672>::</span>declval<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span>()))<span style=color:#f92672>&gt;&gt;</span> <span style=color:#f92672>:</span> std<span style=color:#f92672>::</span>true_type {};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_ss_type<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_ss_type<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_ss_type<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>string<span style=color:#f92672>&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_ss_type<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#75715e># C++11前
</span></span></span><span style=display:flex><span><span style=color:#75715e># 两个Helper表示push_back的参数类型有两种：value_type和const value_type&amp;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>has_push_back</span> {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// value_type：容器存储的类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> C, <span style=color:#66d9ef>void</span> (C<span style=color:#f92672>::*</span>)(<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>typename</span> C<span style=color:#f92672>::</span>value_type<span style=color:#f92672>&amp;</span>)<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Helper</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> C, <span style=color:#66d9ef>void</span> (C<span style=color:#f92672>::*</span>)(<span style=color:#66d9ef>typename</span> C<span style=color:#f92672>::</span>value_type)<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Helper2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> C<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>bool</span> test(...) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> C<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>bool</span> test(Helper<span style=color:#f92672>&lt;</span>C, <span style=color:#f92672>&amp;</span>C<span style=color:#f92672>::</span>push_back<span style=color:#f92672>&gt;*</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> true;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> C<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>bool</span> test(Helper2<span style=color:#f92672>&lt;</span>C, <span style=color:#f92672>&amp;</span>C<span style=color:#f92672>::</span>push_back<span style=color:#f92672>&gt;*</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> true;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_push_back<span style=color:#f92672>::</span>test<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>list<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>&gt;</span>(NULL) <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_push_back<span style=color:#f92672>::</span>test<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>map<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>&gt;</span>(NULL) <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_push_back<span style=color:#f92672>::</span>test<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>set<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>&gt;</span>(NULL) <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_push_back<span style=color:#f92672>::</span>test<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>string<span style=color:#f92672>&gt;</span>(NULL) <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> has_push_back<span style=color:#f92672>::</span>test<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>&gt;</span>(NULL) <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#75715e># Boost
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;boost/tti/has_member_function.hpp&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>ClassWithToString</span> {
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>string to_string() {   <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;with to_string&#34;</span>; }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>ClassWithToStringConst</span> {
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>string to_string() <span style=color:#66d9ef>const</span> {   <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;with to_string&#34;</span>; }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>ClassWithoutToString</span> {
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>BOOST_TTI_HAS_MEMBER_FUNCTION(to_string);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>boolalpha
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;&lt;</span> has_member_function_to_string<span style=color:#f92672>&lt;</span>ClassWithToString, std<span style=color:#f92672>::</span>string<span style=color:#f92672>&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl
</span></span><span style=display:flex><span>        <span style=color:#75715e>// true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>&lt;&lt;</span> has_member_function_to_string<span style=color:#f92672>&lt;</span>ClassWithToStringConst, std<span style=color:#f92672>::</span>string<span style=color:#f92672>&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl
</span></span><span style=display:flex><span>        <span style=color:#75715e>// false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>&lt;&lt;</span> has_member_function_to_string<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>const</span> ClassWithToStringConst, std<span style=color:#f92672>::</span>string<span style=color:#f92672>&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl
</span></span><span style=display:flex><span>        <span style=color:#75715e>// true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>&lt;&lt;</span> has_member_function_to_string<span style=color:#f92672>&lt;</span>ClassWithoutToString, std<span style=color:#f92672>::</span>string<span style=color:#f92672>&gt;::</span>value <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>        <span style=color:#75715e>// false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h2 id=静态成员函数>静态成员函数
<a class=header-anchor href=#%e9%9d%99%e6%80%81%e6%88%90%e5%91%98%e5%87%bd%e6%95%b0></a></h2><p>不能访问<strong>非静态成员变量</strong> 和 <strong>非静态成员函数</strong>，无this指针参数</p><p>作用：</p><ul><li><strong>构造函数或析构函数</strong>可以调用静态成员函数；</li><li>静态成员函数可以调用构造函数</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>class_name</span>{
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> func(){
</span></span><span style=display:flex><span>		...
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>class_name<span style=color:#f92672>::</span>func();
</span></span></code></pre></div><h2 id=crtp调用子类函数>CRTP（调用子类函数）
<a class=header-anchor href=#crtp%e8%b0%83%e7%94%a8%e5%ad%90%e7%b1%bb%e5%87%bd%e6%95%b0></a></h2><p>本质：继承了不同的基类</p><p>作用：父类<strong>实现时</strong>调用子类函数、父类函数返回子类对象</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> Derived<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>SomeBase</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>void</span> <span style=color:#a6e22e>foo</span>(){
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>auto</span> <span style=color:#f92672>&amp;</span>iterm : <span style=color:#f92672>*</span><span style=color:#66d9ef>static_cast</span><span style=color:#f92672>&lt;</span>Derived <span style=color:#f92672>*&gt;</span>(<span style=color:#66d9ef>this</span>)){...}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 实现链式引用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> Derived<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Printer</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  Printer(std<span style=color:#f92672>::</span>ostream<span style=color:#f92672>&amp;</span> pstream)<span style=color:#f92672>:</span> m_stream(pstream){}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>  Derived<span style=color:#f92672>&amp;</span> print(T<span style=color:#f92672>&amp;&amp;</span> t)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    m_stream <span style=color:#f92672>&lt;&lt;</span> t;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>static_cast</span><span style=color:#f92672>&lt;</span>Derived<span style=color:#f92672>&amp;&gt;</span>(<span style=color:#f92672>*</span><span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  std<span style=color:#f92672>::</span>ostream<span style=color:#f92672>&amp;</span> m_stream;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//Derived class
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CoutPrinter</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> Printer<span style=color:#f92672>&lt;</span>CoutPrinter<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    CoutPrinter() <span style=color:#f92672>:</span> Printer(std<span style=color:#f92672>::</span>cout) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    CoutPrinter<span style=color:#f92672>&amp;</span> SetConsoleColor(Color c)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>switch</span> (c)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> Color<span style=color:#f92672>::</span>red:
</span></span><span style=display:flex><span>          std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\033</span><span style=color:#e6db74>[0;31m &#34;</span> <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#f92672>*</span><span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>char</span><span style=color:#f92672>*</span> argv[])
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  CoutPrinter().print(<span style=color:#e6db74>&#34;Hello &#34;</span>).SetConsoleColor(Color<span style=color:#f92672>::</span>red).println(<span style=color:#e6db74>&#34;Printer!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=默认成员函数>默认成员函数
<a class=header-anchor href=#%e9%bb%98%e8%ae%a4%e6%88%90%e5%91%98%e5%87%bd%e6%95%b0></a></h2><p>如果存在自定义构造函数，则不会生成无参构造函数，可通过<code>=default</code>​来让编译器生成无参构造函数，<code>=delete</code>​禁止生成指定函数</p><ul><li>构造函数</li><li>析构函数</li><li>拷贝构造函数</li><li>拷贝赋值函数</li><li>取地址重载</li><li>cosnt取地址重载</li><li>移动构造函数</li><li>移动赋值函数</li></ul><h1 id=大小sizeof>大小sizeof
<a class=header-anchor href=#%e5%a4%a7%e5%b0%8fsizeof></a></h1><ol><li><p>一个对象的大小大于等于所有<strong>非</strong>​**静态成员<sup>（静态（static）成员变量不在对象中存储）</sup>**大小的总和。</p></li><li><p><strong>空类</strong>的大小为1个字节，当类不包含虚函数和非静态数据成员时，其对象大小也为1。</p><blockquote><p>因为空类也可以实例化很多对象，需要实现每个实例在内存中都有一个独一无二的地址。</p></blockquote></li><li><p>虚函数：增加指针<sup>（32位机器为4字节，64位机器为8字节）</sup>指向虚函数<sup>（虚函数本身不占用空间）</sup>表VTable</p></li><li><p>字节对齐：注意包括虚函数表指针（8字节或4字节）</p></li><li><p>单继承：参考内存布局，注意每个字段都需要字节对齐</p></li><li><p>多继承：参考内存布局，注意每个字段都需要字节对齐</p><blockquote><p>注意菱形继承，可能存在多份基类数据</p></blockquote></li><li><p>虚继承：参考内存布局，注意每个字段都需要字节对齐</p></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#75715e>#include&lt;iostream&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>A</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> a;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>myfuncA</span>(){}
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>B</span><span style=color:#f92672>:</span><span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>public</span> A{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>myfunB</span>(){}
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>C</span><span style=color:#f92672>:</span><span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>public</span> A{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>myfunC</span>(){}
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>D</span><span style=color:#f92672>:</span><span style=color:#66d9ef>public</span> B,<span style=color:#66d9ef>public</span> C{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>myfunD</span>(){}
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>void</span>) 
</span></span><span style=display:flex><span>{ 
</span></span><span style=display:flex><span>    cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;A=&#34;</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#66d9ef>sizeof</span>(A)<span style=color:#f92672>&lt;&lt;</span>endl;    <span style=color:#75715e>//result=16 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;B=&#34;</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#66d9ef>sizeof</span>(B)<span style=color:#f92672>&lt;&lt;</span>endl;    <span style=color:#75715e>//result=24   
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;C=&#34;</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#66d9ef>sizeof</span>(C)<span style=color:#f92672>&lt;&lt;</span>endl;    <span style=color:#75715e>//result=24 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;D=&#34;</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#66d9ef>sizeof</span>(D)<span style=color:#f92672>&lt;&lt;</span>endl;    <span style=color:#75715e>//result=32
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>; 
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#75715e>#include&lt;iostream&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>A</span>  
</span></span><span style=display:flex><span>{  
</span></span><span style=display:flex><span>};   
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>B</span>  
</span></span><span style=display:flex><span>{ 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>char</span> ch;  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>func0</span>()  {  }  
</span></span><span style=display:flex><span>};  
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>C</span>   
</span></span><span style=display:flex><span>{ 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>char</span> ch1; 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>char</span> ch2; 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>func</span>()  {  }   
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>func1</span>()  {  }  
</span></span><span style=display:flex><span>}; 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>D</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> A, <span style=color:#66d9ef>public</span> C 
</span></span><span style=display:flex><span>{  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> d;  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>func</span>()  {  }  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>func1</span>()  {  } 
</span></span><span style=display:flex><span>};  
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>E</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> B, <span style=color:#66d9ef>public</span> C 
</span></span><span style=display:flex><span>{  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> e;  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>func0</span>()  {  }  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>func1</span>()  {  } 
</span></span><span style=display:flex><span>}; 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>void</span>) 
</span></span><span style=display:flex><span>{ 
</span></span><span style=display:flex><span>    cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;A=&#34;</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#66d9ef>sizeof</span>(A)<span style=color:#f92672>&lt;&lt;</span>endl;    <span style=color:#75715e>//result=1 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;B=&#34;</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#66d9ef>sizeof</span>(B)<span style=color:#f92672>&lt;&lt;</span>endl;    <span style=color:#75715e>//result=16   
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;C=&#34;</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#66d9ef>sizeof</span>(C)<span style=color:#f92672>&lt;&lt;</span>endl;    <span style=color:#75715e>//result=16 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;D=&#34;</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#66d9ef>sizeof</span>(D)<span style=color:#f92672>&lt;&lt;</span>endl;    <span style=color:#75715e>//result=16 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;E=&#34;</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#66d9ef>sizeof</span>(E)<span style=color:#f92672>&lt;&lt;</span>endl;    <span style=color:#75715e>//result=32 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>; 
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>MyStruct</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> a;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> b;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>char</span> c;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>sizeof</span>(MyStruct) <span style=color:#f92672>=</span> <span style=color:#ae81ff>24</span>
</span></span></code></pre></div><h2 id=字节对齐>字节对齐
<a class=header-anchor href=#%e5%ad%97%e8%8a%82%e5%af%b9%e9%bd%90></a></h2><p>作用：减少<strong>CPU访问内存</strong>数据的次数，提高取数据的效率</p><ol><li>结构体变量的<strong>起始地址</strong>能够被其最宽的成员大小整除</li><li>结构体每个成员相对于起始地址的偏移<strong>能够被其自身大小整除</strong>，如果不能则在前一个成员后面补充字节</li><li>结构体总体大小能够被<strong>最宽的成员的大小</strong>整除，如不能则在后面补充字节</li></ol><p>原理：以向上对齐为例</p><ol><li>将len加上ALIGNVAL-1</li><li>将结果与 ~(ALIGNVAL-1)<sup>(将最后的n位转为0)</sup> 进行按位与，确保是<strong>ALIGNVAL的倍数</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#75715e># 向上对齐，ALIGNVAL对齐大小必须为2的n次幂
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define TYPEALIGN(ALIGNVAL,LEN) \
</span></span></span><span style=display:flex><span><span style=color:#75715e>	(((uintptr_t) (LEN) + ((ALIGNVAL) - 1)) &amp; ~((uintptr_t) ((ALIGNVAL) - 1)))
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># 向下对齐，ALIGNVAL对齐大小必须为2的n次幂，如地址所属页的起始地址
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define TYPEALIGN_DOWN(ALIGNVAL, LEN) \
</span></span></span><span style=display:flex><span><span style=color:#75715e>	(((uintptr_t)(LEN)) &amp; ~((uintptr_t)((ALIGNVAL)-1)))
</span></span></span></code></pre></div><h1 id=构造函数>构造函数
<a class=header-anchor href=#%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0></a></h1><ul><li><p>无返回类型</p></li><li><p>尽量不要抛出异常：无法调用析构函数，可能导致内存泄漏</p></li><li><p>可以函数重载</p></li><li><p><strong>不能是虚函数</strong></p><ul><li>虚函数需要通过对象实例化后的虚函数表来实现，即虚函数表在调用构造函数后才建立。</li><li>虚函数是允许基类指针可以调用子类的方法，而构造函数是子类自己调用的，不可能通过父类的指针或引用去调用</li></ul></li><li><p>调用顺序：基类 - 嵌套类 - 自身</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span>DropTableStmt(<span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>string <span style=color:#f92672>&amp;</span>table_name)
</span></span><span style=display:flex><span>        <span style=color:#f92672>:</span> table_name_(table_name), next(<span style=color:#66d9ef>nullptr</span>)   <span style=color:#75715e>// 初始化列表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>{}
</span></span></code></pre></div><h2 id=删除构造函数>删除构造函数
<a class=header-anchor href=#%e5%88%a0%e9%99%a4%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0></a></h2><ul><li><p>不允许无参构造</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span>class_name()<span style=color:#f92672>=</span><span style=color:#66d9ef>delete</span>;
</span></span></code></pre></div></li><li><p>不允许类外构造实例，例如单例模式</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	class_name(){ }
</span></span></code></pre></div></li></ul><h2 id=禁止隐式类型转换>禁止隐式类型转换
<a class=header-anchor href=#%e7%a6%81%e6%ad%a2%e9%9a%90%e5%bc%8f%e7%b1%bb%e5%9e%8b%e8%bd%ac%e6%8d%a2></a></h2><p>作用：只能显式调用构造函数，防止意外转换</p><p>场景：<strong>单参数</strong>的构造函数</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#66d9ef>explicit</span> <span style=color:#a6e22e>Entity</span>(){}
</span></span></code></pre></div><h2 id=子类构造函数>子类构造函数
<a class=header-anchor href=#%e5%ad%90%e7%b1%bb%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0></a></h2><p>子类创建时会<strong>首先调用父类（虚继承优先）的无参构造函数</strong>，按<code>声明顺序</code>​初始化成员变量，然后调动自身的构造函数</p><p>如果<strong>父类只有有参构造函数</strong>，则子类需要显式调用父类的构造函数</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span>son()<span style=color:#f92672>:</span>father(<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>2</span>) { a<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>; }
</span></span></code></pre></div><h1 id=拷贝构造函数>拷贝构造函数
<a class=header-anchor href=#%e6%8b%b7%e8%b4%9d%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0></a></h1><p>作用：对指针和引用类型进行深拷贝<sup>（分配内存和赋值）</sup></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span>class_name(<span style=color:#66d9ef>const</span> class_name<span style=color:#f92672>&amp;</span> other){
</span></span><span style=display:flex><span>	ptr <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ...;
</span></span><span style=display:flex><span>	data_ <span style=color:#f92672>=</span> othrer.data_;  <span style=color:#75715e>// 非指针成员进行浅拷贝
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>场景：</p><ol><li><p>初始化同类对象（该对象未被初始化）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span>Complex <span style=color:#a6e22e>c2</span>(c1);
</span></span><span style=display:flex><span>Complex c2 <span style=color:#f92672>=</span> c1;
</span></span></code></pre></div></li><li><p>按值传递参数</p></li></ol><h2 id=禁止复制>禁止复制
<a class=header-anchor href=#%e7%a6%81%e6%ad%a2%e5%a4%8d%e5%88%b6></a></h2><ol><li>使用delete；也可设置为private，同时不提供实现</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span>class_name(<span style=color:#66d9ef>const</span> class_name<span style=color:#f92672>&amp;</span>) <span style=color:#f92672>=</span> <span style=color:#66d9ef>delete</span>;
</span></span><span style=display:flex><span>Class_name<span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>operator</span><span style=color:#f92672>=</span>(<span style=color:#66d9ef>const</span> Class_name <span style=color:#f92672>&amp;</span>) <span style=color:#f92672>=</span> <span style=color:#66d9ef>delete</span>;
</span></span></code></pre></div><ol start=2><li>宏定义</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#define DISALLOW_COPY( cname )                    \</span>
</span></span><span style=display:flex><span>	cname<span style=color:#f92672>(</span>const cname &amp;<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> delete; /* NOLINT */    <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>	auto operator<span style=color:#f92672>=(</span>const cname &amp;<span style=color:#f92672>)</span>-&gt;cname &amp; <span style=color:#f92672>=</span> delete;  /* NOLINT */
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define DISALLOW_MOVE( cname )                   \</span>
</span></span><span style=display:flex><span>	cname<span style=color:#f92672>(</span> cname <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>)</span> <span style=color:#f92672>=</span> delete; /* NOLINT */      <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>	auto operator<span style=color:#f92672>=(</span>cname <span style=color:#f92672>&amp;&amp;)</span>-&gt;cname &amp; <span style=color:#f92672>=</span> delete;  /* NOLINT */
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define DISALLOW_COPY_AND_MOVE( cname )       \</span>
</span></span><span style=display:flex><span>	DISALLOW_COPY<span style=color:#f92672>(</span>cname<span style=color:#f92672>)</span>;                         <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>	DISALLOW_MOVE<span style=color:#f92672>(</span>cname<span style=color:#f92672>)</span>;
</span></span></code></pre></div><ol start=3><li>继承noncopyable类</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>noncopyable</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	noncopyable(<span style=color:#66d9ef>const</span> noncopyable<span style=color:#f92672>&amp;</span>) <span style=color:#f92672>=</span> <span style=color:#66d9ef>delete</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>void</span> <span style=color:#66d9ef>operator</span><span style=color:#f92672>=</span>(<span style=color:#66d9ef>const</span> noncopyable<span style=color:#f92672>&amp;</span>) <span style=color:#f92672>=</span> <span style=color:#66d9ef>delete</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>protected</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	noncopyable() <span style=color:#f92672>=</span> <span style=color:#66d9ef>default</span>;
</span></span><span style=display:flex><span>	<span style=color:#f92672>~</span>noncopyable() <span style=color:#f92672>=</span> <span style=color:#66d9ef>default</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BlockingQueue</span> <span style=color:#f92672>:</span> noncopyable {}
</span></span><span style=display:flex><span><span style=color:#75715e>// 默认private继承
</span></span></span></code></pre></div><h2 id=可复制>可复制
<a class=header-anchor href=#%e5%8f%af%e5%a4%8d%e5%88%b6></a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>copyable</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span> <span style=color:#66d9ef>protected</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  copyable() <span style=color:#f92672>=</span> <span style=color:#66d9ef>default</span>;
</span></span><span style=display:flex><span>  <span style=color:#f92672>~</span>copyable() <span style=color:#f92672>=</span> <span style=color:#66d9ef>default</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BlockingQueue</span> <span style=color:#f92672>:</span> copyable {}
</span></span></code></pre></div><h1 id=移动构造函数>移动构造函数
<a class=header-anchor href=#%e7%a7%bb%e5%8a%a8%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0></a></h1><p>作用：以右值临时对象初始化同类对象（未初始化）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span>class_name(class_name <span style=color:#f92672>&amp;&amp;</span> other)<span style=color:#f92672>:</span> object(std<span style=color:#f92672>::</span>move(other.object)) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>this</span><span style=color:#f92672>-&gt;</span>data <span style=color:#f92672>=</span> other._data; <span style=color:#75715e>//将源对象的数据成员的值赋给目标对象
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	other._data <span style=color:#f92672>=</span> <span style=color:#66d9ef>nullptr</span>; <span style=color:#75715e>//将原来内容置空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span><span style=color:#75715e># 使用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>class_name new_owner(std<span style=color:#f92672>::</span>move(old_owner))
</span></span></code></pre></div><h2 id=禁止移动>禁止移动
<a class=header-anchor href=#%e7%a6%81%e6%ad%a2%e7%a7%bb%e5%8a%a8></a></h2><p>参考禁止复制</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span>class_name(classname <span style=color:#f92672>&amp;&amp;</span>) <span style=color:#f92672>=</span> <span style=color:#66d9ef>delete</span>;  <span style=color:#75715e>//移动构造
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>class_name <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>operator</span><span style=color:#f92672>=</span>(class_name <span style=color:#f92672>&amp;&amp;</span>) <span style=color:#f92672>=</span> <span style=color:#66d9ef>delete</span>;  <span style=color:#75715e>//移动赋值
</span></span></span></code></pre></div><h1 id=转换构造函数>转换构造函数
<a class=header-anchor href=#%e8%bd%ac%e6%8d%a2%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0></a></h1><p>作用：将其它类型转换为当前类类型</p><p>特点：</p><ul><li>只能有一个参数的构造函数</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span>string(<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>);
</span></span><span style=display:flex><span>Complex(<span style=color:#66d9ef>double</span> real)<span style=color:#f92672>:</span> m_real(real), m_imag(<span style=color:#ae81ff>0.0</span>){ }
</span></span></code></pre></div><h1 id=析构函数>析构函数~
<a class=header-anchor href=#%e6%9e%90%e6%9e%84%e5%87%bd%e6%95%b0></a></h1><ul><li><p>不能抛出异常：</p><ul><li>导致后续的对象无法被析构，从而资源泄漏</li><li>C++11默认析构函数是noexcept的</li><li>很难被捕获（栈对象离开栈时才调用析构函数，如果在try{}中无法被捕获）</li></ul></li><li><p>不能被重载：构造函数只能有一个，且不能带参数</p></li><li><p>delete时<strong>自动调用</strong>析构函数，并free内存</p></li><li><p>基类的析构函数必须为<strong>虚函数</strong></p><p>使用多态时，如果父类析构函数没有virtual，则不会调用子类的析构函数</p></li><li><p>调用顺序：自身 - 嵌套类 - 父类</p></li></ul><p>作用：释放内存</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#66d9ef>virtual</span> <span style=color:#f92672>~</span>class_name() { }  <span style=color:#75715e>// 基类需要使用virtual
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>e.<span style=color:#f92672>~</span>class_name();   <span style=color:#75715e>// 手动调用析构函数
</span></span></span></code></pre></div><h2 id=子类析构函数>子类析构函数
<a class=header-anchor href=#%e5%ad%90%e7%b1%bb%e6%9e%90%e6%9e%84%e5%87%bd%e6%95%b0></a></h2><p>析构顺序和构造顺序完全相反</p><ul><li><p>栈上对象：先调用子类析构函数，再调用父类析构函数</p></li><li><p>堆上对象：</p><p><strong>父类指针指向子类对象</strong>：如果父类析构函数没有virtual，则不会调用子类的析构函数（如果有virtual，则会调用）</p><p><strong>子类指针指向子类对象</strong>：无论是否有virtual，则都会调用父类和子类的析构函数</p></li></ul><h1 id=赋值函数>赋值函数
<a class=header-anchor href=#%e8%b5%8b%e5%80%bc%e5%87%bd%e6%95%b0></a></h1><p>场景：将对象赋值给已初始化的对象</p><blockquote><p>实现中内存复制可参考内存复制</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#75715e># 赋值函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Class_name<span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>operator</span><span style=color:#f92672>=</span>(<span style=color:#66d9ef>const</span> Class_name <span style=color:#f92672>&amp;</span>other){
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>(<span style=color:#66d9ef>this</span><span style=color:#f92672>!=</span> <span style=color:#f92672>&amp;</span>other){
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>this</span><span style=color:#f92672>-&gt;</span>_len <span style=color:#f92672>=</span> other<span style=color:#f92672>-&gt;</span>_len; <span style=color:#75715e>// 浅拷贝
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (_date)  <span style=color:#75715e>//删除原来的内存
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>     		<span style=color:#66d9ef>delete</span>[] <span style=color:#66d9ef>this</span><span style=color:#f92672>-&gt;</span>_data;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>this</span><span style=color:#f92672>-&gt;</span>_data <span style=color:#f92672>=</span> (<span style=color:#66d9ef>int</span><span style=color:#f92672>*</span>)calloc(<span style=color:#66d9ef>this</span><span style=color:#f92672>-&gt;</span>_len,<span style=color:#66d9ef>sizeof</span>(<span style=color:#66d9ef>int</span>)); <span style=color:#75715e>// 分配内存
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		memcpy(<span style=color:#66d9ef>this</span><span style=color:#f92672>-&gt;</span>_data,other<span style=color:#f92672>-&gt;</span>_data,_len<span style=color:#f92672>*</span><span style=color:#66d9ef>sizeof</span>(<span style=color:#66d9ef>int</span>)); <span style=color:#75715e>// 内存复制
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		other._data <span style=color:#f92672>=</span> <span style=color:#66d9ef>nullptr</span>; <span style=color:#75715e>// 将原指针置空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>this</span><span style=color:#f92672>-&gt;</span>object <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>move(that.object); <span style=color:#75715e>//可移动对象不需要上面三个步骤
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#f92672>*</span><span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e># 移动赋值函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>class_name <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>operator</span><span style=color:#f92672>=</span>(class_name <span style=color:#f92672>&amp;&amp;</span> other);
</span></span><span style=display:flex><span><span style=color:#75715e># 转换赋值函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>unique_ptr<span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>operator</span><span style=color:#f92672>=</span>(T<span style=color:#f92672>*</span> p);
</span></span><span style=display:flex><span><span style=color:#75715e>// 参数可以为其他类型
</span></span></span></code></pre></div><h2 id=禁用赋值>禁用赋值
<a class=header-anchor href=#%e7%a6%81%e7%94%a8%e8%b5%8b%e5%80%bc></a></h2><p>参考对应的禁止复制、禁止移动</p><h1 id=位域>位域
<a class=header-anchor href=#%e4%bd%8d%e5%9f%9f></a></h1><p>作用：压缩内存</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>bs</span> 
</span></span><span style=display:flex><span>{ 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> a:<span style=color:#ae81ff>8</span>; 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> b:<span style=color:#ae81ff>2</span>; 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> c:<span style=color:#ae81ff>6</span>; 
</span></span><span style=display:flex><span>}data;
</span></span><span style=display:flex><span><span style=color:#75715e>// data为bs变量，其中位域a占8位，位域b占2位，位域c占6位(一个字节8位)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>bs</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>unsigned</span> a:<span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>unsigned</span>  <span style=color:#f92672>:</span><span style=color:#ae81ff>0</span> <span style=color:#75715e>/*空域*/</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>unsigned</span> b:<span style=color:#ae81ff>4</span> <span style=color:#75715e>/*从下一单元开始存放*/</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>unsigned</span> c:<span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#75715e>// a占第一字节的4位，后4位填0表示不使用，b从第二字节开始，占用4位，c占用4位
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>data.a <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span></code></pre></div></div><footer class=post-footer><div class=post-tags><a href=/tags/%e7%b1%bb>类</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>
赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.png alt="arukasxy - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.png alt="arukasxy - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right alt=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
类</li><li class=post-copyright-author><strong>本文作者： </strong>arukasxy</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=/post/kind-z2cvctu.html title=类>/post/kind-z2cvctu.html</a></li><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/atom.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/string-string-1g9olm.html rel=next title=string字符串><i class="fa fa-chevron-left"></i> string字符串</a></div><div class="post-nav-prev post-nav-item"><a href=/post/set-pile-2vfocg.html rel=prev title=set堆>set堆
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=waline-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2024
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>arukasxy</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.131.0 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.6.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>粤ICP备 18047355-1 号</a>
<img src=/imgs/gongan.png alt=沪公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402009770" target=_blank>沪公网安备 31011402009770 号</a></div><div class=vendors-list><a target=_blank href=https://github.com title=Github><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/github.svg alt=Github>
</a><span>提供CDN/云资源支持</span></div></div></footer><script type=text/javascript src=/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"/3rd"}},"version":"4.6.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o \n\n可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄\n(Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"2.15.8"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"2.15.8"}}}</script><script type=text/javascript src=/js/main.min.befa9b7d22ec90da86c74c5dbff5ee42c12e9fc6d6f4448bfcc596cc329b19e8.js defer></script></body></html>